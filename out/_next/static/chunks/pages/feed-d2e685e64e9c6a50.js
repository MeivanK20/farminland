(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[986],{7127:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/feed",function(){return n(3886)}])},895:function(t,e,n){"use strict";n.d(e,{I:function(){return r},db:function(){return o}});var a=n(3977),i=n(2370),d=n(9828);let s=(0,a.ZF)({apiKey:"AIzaSyARkaxOazpDx4wcJp1QdB5rf-Zp_JkTAN8",authDomain:"farminland-471ed.firebaseapp.com",projectId:"farminland-471ed",storageBucket:"farminland-471ed.appspot.com",messagingSenderId:"827181575858",appId:"1:827181575858:web:65180613dea356a9e563ab"}),r=(0,i.v0)(s),o=(0,d.ad)(s)},3886:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return u}});var a=n(5893),i=n(7294),d=n(895),s=n(9828),r=n(2370);async function o(t,e,n){let a="".concat(Date.now());await (0,s.pl)((0,s.JU)(d.db,"notifications",t,"items",a),{from:e,message:n,read:!1,timestamp:new Date().toISOString()})}function u(){let[t,e]=(0,i.useState)([]),[n,o]=(0,i.useState)(""),[u,l]=(0,i.useState)(null);(0,i.useEffect)(()=>{let t=(0,r.Aj)(d.I,t=>{t&&l(t)}),n=(0,s.cf)((0,s.hJ)(d.db,"posts"),t=>{e(t.docs.map(t=>({id:t.id,...t.data()})))});return()=>{t(),n()}},[]);let p=async()=>{n.trim()&&(await (0,s.ET)((0,s.hJ)(d.db,"posts"),{content:n,author:u.displayName,authorId:u.uid,timestamp:(0,s.Bt)()}),o(""))};return(0,a.jsxs)("div",{style:{padding:20},children:[(0,a.jsx)("h2",{children:"Fil d’actualit\xe9"}),(0,a.jsx)("textarea",{value:n,onChange:t=>o(t.target.value),placeholder:"Exprimez-vous...",style:{width:"100%",height:80}}),(0,a.jsx)("button",{onClick:p,children:"Publier"}),(0,a.jsx)("hr",{}),t.map(t=>(0,a.jsx)(c,{post:t,currentUser:u},t.id))]})}function c(t){let{post:e,currentUser:n}=t,[r,u]=(0,i.useState)([]),[c,l]=(0,i.useState)(0),[p,h]=(0,i.useState)("");(0,i.useEffect)(()=>{if(!(null==e?void 0:e.id))return;let t=(0,s.cf)((0,s.hJ)(d.db,"posts",e.id,"comments"),t=>{u(t.docs.map(t=>t.data()))}),n=(0,s.cf)((0,s.hJ)(d.db,"posts",e.id,"likes"),t=>{l(t.docs.length)});return()=>{t(),n()}},[e]);let m=async()=>{p.trim()&&(await (0,s.ET)((0,s.hJ)(d.db,"posts",e.id,"comments"),{content:p,author:n.displayName,authorId:n.uid,timestamp:(0,s.Bt)()}),h(""),(null==e?void 0:e.authorId)!==(null==n?void 0:n.uid)&&await o(e.authorId,n.uid,"a comment\xe9 votre publication."))},f=async()=>{await (0,s.ET)((0,s.hJ)(d.db,"posts",e.id,"likes"),{userId:n.uid}),(null==e?void 0:e.authorId)!==(null==n?void 0:n.uid)&&await o(e.authorId,n.uid,"a aim\xe9 votre publication.")};return(0,a.jsxs)("div",{style:{border:"1px solid #ccc",marginTop:20,padding:10},children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("b",{children:e.author})," : ",e.content]}),(0,a.jsxs)("p",{children:["❤️ ",c," J’aime"]}),(0,a.jsx)("button",{onClick:f,children:"J’aime"}),(0,a.jsxs)("div",{style:{marginTop:10},children:[(0,a.jsx)("h4",{children:"Commentaires"}),r.map((t,e)=>(0,a.jsxs)("p",{children:[(0,a.jsx)("b",{children:t.author}),": ",t.content]},e)),(0,a.jsx)("input",{type:"text",value:p,onChange:t=>h(t.target.value),placeholder:"Ajouter un commentaire"}),(0,a.jsx)("button",{onClick:m,children:"Commenter"})]})]})}}},function(t){t.O(0,[16,290,554,888,774,179],function(){return t(t.s=7127)}),_N_E=t.O()}]);